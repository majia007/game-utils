<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
	<title>迷雾大陆 - 瞳炉升级</title>
	<!-- 引入工具 -->
	<link href="../assets/common.css">
	<script src="../assets/tools.js"></script>
	<!-- 当前页面工具 -->
	<script>
		function expRequired(target) {
			let all = target * 10e4;
			if (target <= 10) return all;
			all += (target - 10) * 5e4;
			if (target <= 20) return all;
			all += (target - 20) * 5e4;
			if (target <= 30) return all;
			all += (target - 30) * 5e4;
			if (target <= 40) return all;
			all += (target - 40) * 5e4;
			return all;
		}
		function calc(current, target) {
			const all = expRequired(target) - expRequired(current);
			return {
				经验: all,
				铜币: all / 10,
				铜券: all / 10 / 50,
				铜组: Math.ceil(all / 10 / 50 / 99 * 10) / 10,
				银币: all / 25,
				银券: all / 25 / 50,
				银组: Math.ceil(all / 25 / 50 / 99 * 10) / 10,
				金币: all / 50,
				金券: all / 50 / 50,
				金组: Math.ceil(all / 50 / 50 / 99 * 10) / 10,
			};
		}
	</script>
</head>
<body>
	<label>
		当前等级
		<input type="text" id="current" data-default="0" data-min="0" data-max="499">
	</label>
	<br>
	<label>
		目标等级
		<input type="text" id="target" data-default="500" data-min="1" data-max="500">
	</label>
	<hr>
	<output id="output"></output>
	<script>
		const current = document.getElementById('current');
		const target = document.getElementById('target');
		const output = document.getElementById('output');
		function 计算() {
			if (!current.value.trim() || !target.value.trim()) {
				output.innerHTML = '-';
				return;
			}
			const result = calc(+current.value, +target.value);
			output.innerHTML = `
<table border="1" style="border-collapse: collapse" cellpadding="10">
	<tr><th>经验: ${result.经验}</th><td>币</td><td>券</td><td>组</td></tr>
	<tr><th>铜</th><td>${result.铜币}</td><td>${result.铜券}</td><td>${result.铜组}</td>
	<tr><th>银</th><td>${result.银币}</td><td>${result.银券}</td><td>${result.银组}</td></tr>
	<tr><th>金</th><td>${result.金币}</td><td>${result.金券}</td><td>${result.金组}</td></tr>
</table>`;
		}
	</script>
	<script type="module">
		const canvas = document.createElement('canvas');
		import('https://cdn.jsdelivr.net/npm/qrcode@1.5.4/+esm').then((QRCode) => {
			QRCode.toCanvas(canvas, location.href);
			document.body.append(canvas);
		});
	</script>
</body>
</html>
